{"version":3,"file":"devlevel.js","sources":["../src/index.js"],"sourcesContent":["const toStr = Object.prototype.toString\r\nconst conditions = {\r\n\tfinite(o) {\r\n\t\treturn o === o && o !== Infinity && toStr.call(o) === '[object Number]'\r\n\t}\r\n}\r\n\r\nconst byteArray = ['Uint8Array', 'Int8Array']\r\nconst shortArray = ['Uint16Array', 'Int16Array']\r\nconst intArray = ['Uint32Array', 'Int32Array']\r\nconst floatArray = ['Float32Array', 'Float64Array']\r\nconst arrayBuffer = 'ArrayBuffer'\r\nconst typedArrays = byteArray.concat(shortArray).concat(intArray).concat(floatArray).concat(arrayBuffer)\r\n\r\ncon(isStr, 'bool', 'Boolean')\r\ncon(isStr, 'num', 'Number')\r\ncon(isStr, 'str', 'String')\r\ncon(isType, 'fn', 'function')\r\ncon(isStr, 'date', 'Date')\r\ncon(isStr, 'array', 'Array')\r\nfor (let i = 0; i < typedArrays.length; i++)\r\n\tcon(isStr, typedArrays[i].replace(/^[a-zA-Z]/, o => o.toLowerCase()), typedArrays[i])\r\ncon(isStr, 'byteArray', byteArray)\r\ncon(isStr, 'shortArray', shortArray)\r\ncon(isStr, 'intArray', intArray)\r\ncon(isStr, 'floatArray', floatArray)\r\ncon(isStr, 'arrayBuffer', arrayBuffer)\r\ncon(isStr, 'typedArray', typedArrays)\r\ncon(isStr, 'array', 'Array')\r\ncon(isStr, 'array', 'Array')\r\ncon(isStr, 'reg', 'RegExp')\r\ncon(isStr, 'obj', 'Object')\r\ncon(isStr, 'err', 'Error')\r\ncon(isStr, 'arrayLike', ['Array', 'Arguments', 'NodeList'].concat(typedArrays))\r\ncon(isValue, 'nil', ['undefined', 'null'])\r\ncon(isValue, 'nul', 'null')\r\ncon(isValue, 'undef', 'undefined', 0, 0)\r\ncon(isValue, 'def', 'undefined', 1, 0)\r\ncon(isValue, 'NaN', 'o', 1)\r\ncon(isValue, 'infinite', 'Infinity')\r\ncon((v, isNot) => isExpr(['a', 'b'], `return ${isNot ? '!':''}(a===b||(a!==a&&b!==b));`), 'eq')\r\n\r\nfunction con(is, name, value, isNot = 0, addNot = 1) {\r\n\tlet fn = conditions[name] = is(value, isNot)\r\n\tfn.__name__ = name\r\n\tif (addNot) {\r\n\t\tname = 'not' + name.replace(/^[a-zA-Z]/, o => o.toUpperCase())\r\n\t\tfn = conditions[name] = is(value, !isNot)\r\n\t\tfn.__name__ = name\r\n\t}\r\n}\r\n\r\nfunction isType(t, isNot) {\r\n\treturn isIn('o', 'typeof o', t, isNot, t => `'${t}'`)\r\n}\r\n\r\nfunction isStr(s, isNot) {\r\n\treturn isIn('o', 'Object.prototype.toString.call(o)', s, isNot, s => `'[object ${s}]'`)\r\n}\r\n\r\nfunction isValue(v, isNot) {\r\n\treturn isIn('o', 'o', v, isNot)\r\n}\r\n\r\nfunction isIn(params, condition, cases, isNot, valueHandle) {\r\n\tif (!(cases instanceof Array)) cases = [cases]\r\n\tconst len = cases.length\r\n\tif (valueHandle) {\r\n\t\tvar i = len,\r\n\t\t\tarr = new Array(len)\r\n\t\twhile (i--) arr[i] = valueHandle(cases[i])\r\n\t\tcases = arr\r\n\t}\r\n\treturn isExpr(params, len > 1 ? `switch(${condition}){\r\ncase ${cases.join(':\\n\\t\\tcase ')}:\r\nreturn ${!isNot};\r\ndefault:\r\nreturn ${!!isNot};\r\n}` : `return (${condition})${isNot ? '!': '='}==${cases[0]};`)\r\n}\r\n\r\n\r\nfunction isExpr(params, expr) {\r\n\tif (!(params instanceof Array))\r\n\t\tparams = [params]\r\n\tconst fn = Function.apply(Function, params.concat(expr.apply ? expr(params) : expr))\r\n\tfn.params = params\r\n\treturn fn\r\n}\r\n\r\nfunction _if(condition, callback, isNot) {\r\n\tconst params = condition.params || ['o']\r\n\treturn new Function('condition', 'callback', 'slice', `return function(${params.join(',')}){\r\nif(${isNot ? '!' : ''}condition(${params.join(',')}))\r\n    callback(slice(arguments, ${params.length}));\r\n}`)(condition, callback, sliceArgs)\r\n}\r\n\r\nfunction assignCons(obj, callback, isNot) {\r\n\tfor (let name in conditions)\r\n\t\tobj[name] = _if(conditions[name], callback, isNot)\r\n}\r\n\r\nfunction callBy(condition, cb) {\r\n\tswitch (arguments.length) {\r\n\t\tcase 0:\r\n\t\t\treturn\r\n\t\tcase 1:\r\n\t\t\tcondition()\r\n\t\t\treturn\r\n\t\tdefault:\r\n\t\t\tcondition && cb()\r\n\t}\r\n}\r\nexport function exception(error) {\r\n\tif (typeof error === 'function')\r\n\t\terror = error()\r\n\tif (error instanceof Error) throw error\r\n\tthrow new Error(error)\r\n}\r\n\r\nexport function assert(condition, error) {\r\n\tif (!condition) exception(error)\r\n}\r\nassignCons(assert, (args) => exception(args[0]), 1)\r\nassert.by = callBy\r\n\r\n\r\nlet currentLevel = 1\r\nconst logs = []\r\nconst logMap = {}\r\n\r\nexport const debug = createLog('debug', 0)\r\nexport const info = createLog('info', 1)\r\nexport const warn = createLog('warn', 2)\r\nexport const error = createLog('error', 3)\r\n\r\nif (!console) console = {\r\n\tlog() {}\r\n}\r\n\r\nfunction createLog(name, level) {\r\n\tif (!console[name]) console[name] = console.log\r\n\r\n\tfunction print(args) {\r\n\t\targs.length && console[name].apply(console, [mark].concat(args))\r\n\t}\r\n\r\n\tfunction log() {\r\n\t\tprint(arguments)\r\n\t}\r\n\tlog.level = level\r\n\tlog.methods = getLogMethods(name, print)\r\n\tlogs[name] = log\r\n\tlogMap[level] = log\r\n\treturn bindLog(log)\r\n}\r\n\r\nfunction getLogMethods(name, print) {\r\n\tconst mark = `[${name}]: `\r\n\treturn assignCons({\r\n\t\tby: callBy,\r\n\t\twhen(condition) {\r\n\t\t\tcondition && this.print(sliceArgs(arguments, 1))\r\n\t\t},\r\n\t\tprint\r\n\t}, print)\r\n}\r\n\r\nfunction bindLog(log) {\r\n\tconst {\r\n\t\tlevel,\r\n\t\tmethods\r\n\t} = log\r\n\tfor (let method in methods) {\r\n\t\tlog[method] = level < currentLevel ? empty : methods[method]\r\n\t}\r\n\treturn log\r\n}\r\n\r\nexport function setLogLevel(level) {\r\n\tconst log = logMap[level]\r\n\tif (log) {\r\n\t\tconst level = log.level\r\n\t\tconst min = Math.min(level, currentLevel)\r\n\t\tconst max = Math.min(level, currentLevel)\r\n\t\tfor (let i = min; i <= max; i++) {\r\n\t\t\tbindLog(logs[i])\r\n\t\t}\r\n\t\tcurrentLevel = level\r\n\t}\r\n}\r\n\r\nfunction sliceArgs(args, offset) {\r\n\tlet len = args.length\r\n\tconst arr = new Array(len - offset)\r\n\twhile (len-- > offset)\r\n\t\tarr[len - offset] = args[len]\r\n\treturn arr\r\n}"],"names":["toStr","Object","prototype","toString","conditions","o","Infinity","call","byteArray","shortArray","intArray","floatArray","arrayBuffer","typedArrays","concat","con","isStr","isType","i","length","replace","toLowerCase","isValue","v","isNot","isExpr","is","name","value","addNot","fn","__name__","toUpperCase","t","isIn","s","params","condition","cases","valueHandle","Array","len","arr","join","expr","Function","apply","_if","callback","sliceArgs","assignCons","obj","callBy","cb","arguments","exception","error","Error","assert","args","by","currentLevel","logs","logMap","debug","createLog","info","warn","console","level","log","print","mark","methods","getLogMethods","bindLog","method","empty","setLogLevel","min","Math","max","offset"],"mappings":"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"}